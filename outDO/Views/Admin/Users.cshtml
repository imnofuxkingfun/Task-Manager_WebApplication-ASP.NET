@using Microsoft.AspNetCore.Identity
@inject UserManager<User> UserManager

<body>

	<div>
		<h2 class="display-2">USER MANAGEMENT</h2>
		<a class="btn btn-success mb-3" asp-controller="Admin" asp-action="GoBack">Go Back</a>
		<h2>Admins</h2>
		<div class="card mt-3">
			<div class="row align-items-center mb-2 card-body">
				<div class="col-auto ">
					<h5>@UserManager.GetUserName(User)</h5>
				</div>
				<div class="col text-end ">
					<a class="btn btn-outline-primary" asp-controller="Admin" asp-action="RemoveAdmin" asp-route-id="@UserManager.GetUserId(User)">Step Down From Admin</a>
					@if (TempData["AdminAlertMessage"] != null)
					{
						<div class="alert alert-danger alert-dismissible fade show" role="alert">
							@TempData["AdminAlertMessage"]
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
						</div>
					}
				</div>
			</div>
		</div>

		@foreach (var admin in ViewBag.admins)
		{
			<div class="card mt-3">
				<div class="row align-items-center mb-2 card-body">
					<div class="col-auto ">
						<h5>@admin.UserName</h5>
						<p>@admin.Email</p>
					</div>
				</div>
			</div>
		}
		<hr />
		<h2>Users</h2>
		@foreach (var user in ViewBag.users)
		{
			<div class="card mt-3">
				<div class="row align-items-center mb-2 card-body">
					<div class="col-auto ">
						<h5>@user.UserName</h5>
						<p>@user.Email</p>
					</div>
					<div class="col text-end ">
						<a class="btn btn-outline-primary" asp-controller="Admin" asp-action="AddAdmin" asp-route-id="@user.Id">Make Admin</a>
						
						<a class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#deleteUserModal-@user.Id">Delete User</a>

						<!-- pop up daca esti sigur-->
						<div class="modal fade" id="deleteUserModal-@user.Id" tabindex="-1" aria-labelledby="deleteUserModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="deleteUserModalLabel">Confirm Delete</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										Are you sure you want to delete this user?
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
										<a class="btn btn-danger" asp-controller="Admin" asp-action="DeleteUser" asp-route-id="@user.Id">Delete</a>
									</div>
								</div>
							</div>
						</div>

						<a class="btn btn-outline-primary" asp-controller="Admin" asp-action="BanUser" asp-route-id="@user.Id">Ban User</a>
					</div>
				</div>
			</div>
		}

	</div>
</body>